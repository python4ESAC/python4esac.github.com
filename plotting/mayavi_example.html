

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3D plotting with Mayavi &mdash; Python4Astronomers 1.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Python4Astronomers 1.1 documentation" href="../index.html" />
    <link rel="up" title="Plotting and Images" href="plotting.html" />
    <link rel="next" title="Advanced plotting" href="advanced.html" />
    <link rel="prev" title="CONTEST: Make a fun bouncing balls demo" href="../contest/bounce.html" />
 
<script type="text/javascript"> 
$(document).ready(function(){

$(".flip0").click(function(){
    $(".panel0").slideToggle("normal");
  });

$(".flip1").click(function(){
    $(".panel1").slideToggle("normal");
  });

$(".flip2").click(function(){
    $(".panel2").slideToggle("normal");
  });

$(".flip3").click(function(){
    $(".panel3").slideToggle("normal");
  });

$(".flip4").click(function(){
    $(".panel4").slideToggle("normal");
  });

$(".flip5").click(function(){
    $(".panel5").slideToggle("normal");
  });

$(".flip6").click(function(){
    $(".panel6").slideToggle("normal");
  });

$(".flip7").click(function(){
    $(".panel7").slideToggle("normal");
  });

$(".flip8").click(function(){
    $(".panel8").slideToggle("normal");
  });

$(".flip9").click(function(){
    $(".panel9").slideToggle("normal");
  });

});
</script>
 
<style type="text/css"> 

div.panel0,p.flip0
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip0
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel0
{
display:none;
}

div.panel1,p.flip1
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip1
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel1
{
display:none;
}

div.panel2,p.flip2
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip2
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel2
{
display:none;
}

div.panel3,p.flip3
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip3
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel3
{
display:none;
}

div.panel4,p.flip4
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip4
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel4
{
display:none;
}

div.panel5,p.flip5
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip5
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel5
{
display:none;
}

div.panel6,p.flip6
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip6
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel6
{
display:none;
}

div.panel7,p.flip7
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip7
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel7
{
display:none;
}

div.panel8,p.flip8
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip8
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel8
{
display:none;
}

div.panel9,p.flip9
{
    font-size: 0.9em;
    margin: 0;
    padding: 0.1em 0 0.1em 0.5em;
    border-bottom: 1px solid #86989B;
}
p.flip9
{
    color: white;
    font-weight: bold;
    background-color: #AFC1C4;
}
div.panel9
{
display:none;
}

</style>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-18709417-2']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="advanced.html" title="Advanced plotting"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../contest/bounce.html" title="CONTEST: Make a fun bouncing balls demo"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Python4Astronomers 1.1 documentation</a> &raquo;</li>
          <li><a href="plotting.html" accesskey="U">Plotting and Images</a> &raquo;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3D plotting with Mayavi</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#a-binary-system">A binary system</a></li>
<li><a class="reference internal" href="#the-code">The code</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../contest/bounce.html"
                        title="previous chapter">CONTEST: Make a fun bouncing balls demo</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="advanced.html"
                        title="next chapter">Advanced plotting</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/plotting/mayavi_example.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <p>: tocdepth: 2</p>
<div class="section" id="d-plotting-with-mayavi">
<h1><a class="toc-backref" href="#id1">3D plotting with Mayavi</a><a class="headerlink" href="#d-plotting-with-mayavi" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#d-plotting-with-mayavi" id="id1">3D plotting with Mayavi</a><ul>
<li><a class="reference internal" href="#introduction" id="id2">Introduction</a></li>
<li><a class="reference internal" href="#a-binary-system" id="id3">A binary system</a></li>
<li><a class="reference internal" href="#the-code" id="id4">The code</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id2">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>Mayavi is general 3D visualisation tool, for which python wrappers are available.
There are a lot of parallels between matplotlib and mayavi:</p>
<blockquote>
<div><ul class="simple">
<li>there exists huge object-oriented library, allowing you to control even the smallest detail in a plot.</li>
<li>there exists a module around that library called <tt class="docutils literal"><span class="pre">mlab</span></tt>, similar (and in fact inspired by) <tt class="docutils literal"><span class="pre">pylab</span></tt>.</li>
</ul>
</div></blockquote>
<p>There are of course differences too. An advantage of <tt class="docutils literal"><span class="pre">mlab</span></tt> over <tt class="docutils literal"><span class="pre">pylab</span></tt> is
its visualisation tool: the interactive display is <em>much</em> faster working in 3D
than <tt class="docutils literal"><span class="pre">pylab</span></tt>&#8216;s 3D toolkit. A disadvantage of <tt class="docutils literal"><span class="pre">mlab</span></tt> is that it is much more
difficult to make publication quality plots.</p>
</div>
<div class="section" id="a-binary-system">
<h2><a class="toc-backref" href="#id3">A binary system</a><a class="headerlink" href="#a-binary-system" title="Permalink to this headline">¶</a></h2>
<p>In this example we&#8217;ll try to reproduce the shapes of stars in a close binary
system, one of which almost fills its Roche lobe. We will use <tt class="docutils literal"><span class="pre">mlab</span></tt> and
<tt class="docutils literal"><span class="pre">pylab</span></tt> to visualise the shapes.</p>
</div>
<div class="section" id="the-code">
<h2><a class="toc-backref" href="#id4">The code</a><a class="headerlink" href="#the-code" title="Permalink to this headline">¶</a></h2>
<p>First, we need to import some stuff: numpy, pylab and of course mlab. Also,
we need an optimizer, because there is no analytical representation of the Roche
surface. We will use the Newton-Raphson gradient method from SciPy&#8217;s suite of
optimizers.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="gp">In [2]: </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span><span class="n">cos</span><span class="p">,</span><span class="n">pi</span><span class="p">,</span><span class="n">sqrt</span> <span class="c"># makes the code more readable</span>

<span class="gp">In [3]: </span><span class="kn">import</span> <span class="nn">pylab</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="gp">In [4]: </span><span class="kn">from</span> <span class="nn">mayavi</span> <span class="kn">import</span> <span class="n">mlab</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">ImportError                               Traceback (most recent call last)</span>
<span class="go">/home/nhmc/code/repo/python4ESAC/source/py4ast/core/&lt;ipython-input-4-3f0e4b94a8ea&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 from mayavi import mlab</span>

<span class="go">ImportError: No module named mayavi</span>

<span class="gp">In [5]: </span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">newton</span>
</pre></div>
</div>
<p>SciPy&#8217;s optimizers usually need a function that returns the residuals of a fitting
function. In this case, we want to fit the Roche surface (let us simplify it to
a circular, synchronized system). We will use spherical coordinates, and assume
that we want to find the radius <tt class="docutils literal"><span class="pre">r</span></tt> given the colatitude <tt class="docutils literal"><span class="pre">theta</span></tt> and longitude
<tt class="docutils literal"><span class="pre">phi</span></tt>. The fit-parameter <tt class="docutils literal"><span class="pre">r</span></tt> needs to be the first argument to the function,
the order of the other parameters is not important.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="k">def</span> <span class="nf">roche</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span><span class="p">,</span><span class="n">pot</span><span class="p">,</span><span class="n">q</span><span class="p">):</span>

<span class="gp">In [1]: </span>    <span class="n">lamr</span><span class="p">,</span><span class="n">nu</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="gp">In [1]: </span>    <span class="k">return</span> <span class="p">(</span><span class="n">pot</span> <span class="o">-</span> <span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="n">r</span>  <span class="o">+</span> <span class="n">q</span><span class="o">*</span><span class="p">(</span> <span class="mf">1.</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">lamr</span> <span class="o">+</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">lamr</span><span class="p">)</span>  <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">q</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">r</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">nu</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="p">))</span>

<span class="gp">In [1]: </span>
</pre></div>
</div>
<p>Next, we generate a grid in colatitude and longitude. We take 75 points in the
colatitudinal direction (between 0 and pi), and 150 points in the longitudinal
direction (between 0 and 2pi, but we shift the zeropoint with pi/2 to make nicer
plots later on).</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">theta</span><span class="p">,</span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mgrid</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="mi">75</span><span class="n">j</span><span class="p">,</span><span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">pi</span><span class="p">:</span><span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span><span class="mi">150</span><span class="n">j</span><span class="p">]</span>
</pre></div>
</div>
<p>The Roche lobe filling star has a potential value of 2.88, the companion is smaller
and has a potential of 10. The Roche lobe filling star is twice as massive as the
secondary.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">pot1</span><span class="p">,</span><span class="n">pot2</span> <span class="o">=</span> <span class="mf">2.88</span><span class="p">,</span><span class="mf">10.</span>

<span class="gp">In [2]: </span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.5</span>
</pre></div>
</div>
<p>We need a good starting value to start the Newton-Raphson method so
that it can descend to the true value. We could do that by first checking what
the expected shape of the star is. However, since the Roche potential behaves well,
we can be lazy and choose a value very close to (but not equal to) 0. We take an
arbitrary 0.00001.</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">r_init</span> <span class="o">=</span> <span class="mf">1e-5</span>
</pre></div>
</div>
<p>Next, we need to iterate over all coordinates <tt class="docutils literal"><span class="pre">theta</span></tt> and <tt class="docutils literal"><span class="pre">phi</span></tt>, and apply
the Newton-Raphson method to find the radius (slow!). We constructed a two
dimensional grid of coordinates, which is a bit anoying to iterate over (though
possible for sure!). In this approach, we make the colatitude and longitude
1D dimensional first, and iterate simultaneously over <tt class="docutils literal"><span class="pre">theta</span></tt> and <tt class="docutils literal"><span class="pre">phi</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">r1</span> <span class="o">=</span> <span class="p">[</span><span class="n">newton</span><span class="p">(</span><span class="n">roche</span><span class="p">,</span><span class="n">r_init</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="p">,</span><span class="n">pot1</span><span class="p">,</span><span class="n">q</span><span class="p">))</span> <span class="k">for</span> <span class="n">th</span><span class="p">,</span><span class="n">ph</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span><span class="n">phi</span><span class="o">.</span><span class="n">ravel</span><span class="p">())]</span>

<span class="gp">In [2]: </span><span class="n">r2</span> <span class="o">=</span> <span class="p">[</span><span class="n">newton</span><span class="p">(</span><span class="n">roche</span><span class="p">,</span><span class="n">r_init</span><span class="p">,</span><span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">th</span><span class="p">,</span><span class="n">ph</span><span class="p">,</span><span class="n">pot2</span><span class="p">,</span><span class="mf">1.</span><span class="o">/</span><span class="n">q</span><span class="p">))</span> <span class="k">for</span> <span class="n">th</span><span class="p">,</span><span class="n">ph</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">ravel</span><span class="p">(),</span><span class="n">phi</span><span class="o">.</span><span class="n">ravel</span><span class="p">())]</span>
</pre></div>
</div>
<p>The approach with list-comprehension implies that we need to convert the radii for
both components explicitly to an array type, and we reshape it to match the
original shape of <tt class="docutils literal"><span class="pre">theta</span></tt> and <tt class="docutils literal"><span class="pre">phi</span></tt>:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">r1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">r2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">theta</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p>That&#8217;s basically it! We did everything in spherical coordinates because that is
most natural in this case. To plot, however, we need cartesian coordinates:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">x1</span> <span class="o">=</span> <span class="n">r1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">y1</span> <span class="o">=</span> <span class="n">r1</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">z1</span> <span class="o">=</span> <span class="n">r1</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">x2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

<span class="gp">In [2]: </span><span class="n">y2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>

<span class="gp">In [3]: </span><span class="n">z2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</pre></div>
</div>
<p>Plotting with Mayavi is now as simple as with matplotlib. We color the surface
according the size of the radius. An interactive display should appear after
executing these commands (else, use <tt class="docutils literal"><span class="pre">mlab.show()</span></tt>):</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">/home/nhmc/code/repo/python4ESAC/source/py4ast/core/&lt;ipython-input-1-28cec454b7a9&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 mlab.figure()</span>

<span class="go">NameError: name &#39;mlab&#39; is not defined</span>

<span class="gp">In [2]: </span><span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">r1</span><span class="p">)</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">/home/nhmc/code/repo/python4ESAC/source/py4ast/core/&lt;ipython-input-2-841728bc45e1&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 mlab.mesh(x1,y1,z1,scalars=r1)</span>

<span class="go">NameError: name &#39;mlab&#39; is not defined</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/mayavi_prim.png"><img alt="../_images/mayavi_prim.png" src="../_images/mayavi_prim.png" style="width: 400.0px; height: 325.0px;" /></a>
<p>So what about the secondary? Because of the definition of the Roche surface we
used, both stars are made in the same coordinate system, so they will overlap.
We can easily but the secondary in its place by executing:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">x2_</span> <span class="o">=</span> <span class="o">-</span><span class="n">x2</span>

<span class="gp">In [2]: </span><span class="n">x2_</span><span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>But we choose to do it the hard (but more general) way: via a proper coordinate
transformation. The secondary needs to be rotated around the Z-axis, and then
moved to its proper coordinates:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">rot_angle</span> <span class="o">=</span> <span class="n">pi</span>

<span class="gp">In [2]: </span><span class="n">Rz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cos</span><span class="p">(</span><span class="n">rot_angle</span><span class="p">),</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">rot_angle</span><span class="p">),</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">   ...:</span>                 <span class="p">[</span><span class="n">sin</span><span class="p">(</span><span class="n">rot_angle</span><span class="p">),</span> <span class="n">cos</span><span class="p">(</span><span class="n">rot_angle</span><span class="p">),</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">   ...:</span>                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span>             <span class="mi">0</span><span class="p">,</span>              <span class="mi">1</span><span class="p">]])</span>
<span class="gp">   ...:</span> 

<span class="gp">In [3]: </span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Rz</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)))</span> <span class="c"># we need to have a 3x3 times 3xN array</span>

<span class="gp">In [4]: </span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span> <span class="o">=</span> <span class="n">B</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="n">x2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">x2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="c"># but we want our original shape back</span>

<span class="gp">In [5]: </span><span class="n">x2</span> <span class="o">+=</span> <span class="mi">1</span> <span class="c"># simple translation</span>
</pre></div>
</div>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">mlab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">/home/nhmc/code/repo/python4ESAC/source/py4ast/core/&lt;ipython-input-1-28cec454b7a9&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 mlab.figure()</span>

<span class="go">NameError: name &#39;mlab&#39; is not defined</span>

<span class="gp">In [2]: </span><span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">y1</span><span class="p">,</span><span class="n">z1</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">r1</span><span class="p">)</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">/home/nhmc/code/repo/python4ESAC/source/py4ast/core/&lt;ipython-input-2-841728bc45e1&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 mlab.mesh(x1,y1,z1,scalars=r1)</span>

<span class="go">NameError: name &#39;mlab&#39; is not defined</span>

<span class="gp">In [3]: </span><span class="n">mlab</span><span class="o">.</span><span class="n">mesh</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="n">y2</span><span class="p">,</span><span class="n">z2</span><span class="p">,</span><span class="n">scalars</span><span class="o">=</span><span class="n">r2</span><span class="p">)</span>
<span class="go">---------------------------------------------------------------------------</span>
<span class="go">NameError                                 Traceback (most recent call last)</span>
<span class="go">/home/nhmc/code/repo/python4ESAC/source/py4ast/core/&lt;ipython-input-3-d11dcb88da02&gt; in &lt;module&gt;()</span>
<span class="go">----&gt; 1 mlab.mesh(x2,y2,z2,scalars=r2)</span>

<span class="go">NameError: name &#39;mlab&#39; is not defined</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/mayavi_bin.png"><img alt="../_images/mayavi_bin.png" src="../_images/mayavi_bin.png" style="width: 400.0px; height: 325.0px;" /></a>
<p>All the arrays presented above are 2D. This means we could also feed the radius
array to pylab and make a color plot:</p>
<div class="highlight-ipython"><div class="highlight"><pre><span class="gp">In [1]: </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">r1</span><span class="p">)</span>
<span class="gr">Out[1]: </span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">AxesImage</span> <span class="n">at</span> <span class="mh">0x676e1d0</span><span class="o">&gt;</span>

<span class="gp">In [2]: </span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="gr">Out[2]: </span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">Colorbar</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x6ac57e8</span><span class="o">&gt;</span>

<span class="gp">In [3]: </span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">r2</span><span class="p">)</span>
<span class="gr">Out[3]: </span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">AxesImage</span> <span class="n">at</span> <span class="mh">0x4624e50</span><span class="o">&gt;</span>

<span class="gp">In [4]: </span><span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="gr">Out[4]: </span><span class="o">&lt;</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">colorbar</span><span class="o">.</span><span class="n">Colorbar</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x6acf440</span><span class="o">&gt;</span>
</pre></div>
</div>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="first last reference internal image-reference" href="../_images/pylab_prim.png"><img alt="../_images/pylab_prim.png" src="../_images/pylab_prim.png" style="width: 609.0px; height: 459.0px;" /></a>
</td>
<td><a class="first last reference internal image-reference" href="../_images/pylab_sec.png"><img alt="../_images/pylab_sec.png" src="../_images/pylab_sec.png" style="width: 609.0px; height: 459.0px;" /></a>
</td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="advanced.html" title="Advanced plotting"
             >next</a> |</li>
        <li class="right" >
          <a href="../contest/bounce.html" title="CONTEST: Make a fun bouncing balls demo"
             >previous</a> |</li>
        <li><a href="../index.html">Python4Astronomers 1.1 documentation</a> &raquo;</li>
          <li><a href="plotting.html" >Plotting and Images</a> &raquo;</li> 
      </ul>
    </div>
 <small>Copyright:
 Smithsonian Astrophysical Observatory under terms of
 <a rel="license"
 href="http://creativecommons.org/licenses/by/3.0/">CC
 Attribution 3.0</a></small> <a rel="license"
 href="http://creativecommons.org/licenses/by/3.0/"><img alt="Creative Commons
 License" style="border-width:0"
 src="http://i.creativecommons.org/l/by/3.0/80x15.png" /></a>

  </body>
</html>